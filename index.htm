<!DOCTYPE html>

<html lang="no">
<head>

	<title>Pick-a-flick</title>

	<meta charset="utf-8">
	<!-- <link rel="stylesheet" 	type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.1/normalize.min.css">
     <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
 -->
    <style type="text/css" media="screen">
        *, *:after, *:before { -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; }
    </style>
	<!--[if lt IE 9]>
	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js">
		</script>
	<![endif]-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
</head>
<body>

	<pre id="object">

	</pre>

	<ul id="list">

	</ul>



		<form class="new-movie" action="index.html" method="post">
			<input type="text" name="film-name" value="Name of film">
			<input type="button" name="submit" value="Enter">
		</form>

  <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyD_0j_9n_JmHKTvTO3nqNx29iwG-C94i9A",
      authDomain: "pickaflick-cb0aa.firebaseapp.com",
      databaseURL: "https://pickaflick-cb0aa.firebaseio.com",
      storageBucket: "pickaflick-cb0aa.appspot.com",
      messagingSenderId: "342630504231"
    };
    firebase.initializeApp(config);

		// Get elements

		const preObject = document.getElementById('object');
		const ulList = document.getElementById('list');

		// Create reference

		const dbRefObject = firebase.database().ref().child('object');
		const dbRefList = dbRefObject.child('Hobbies');

		// One powerful method you need to know it's ON
		// Sync object changes

		// dbRefObject.on('value', snap => console.log(snap.val()));

		// Sync object changes
		dbRefObject.on('value', snap => {
			// preObject.innerText = 'I am static';
		preObject.innerText = JSON.stringify(snap.val(), null, 3);

		});
		// Sync list changes

		dbRefList.on('child_added', snap => console.log(snap.val()));
		//
		dbRefList.on('child_added', snap => {

			const li = document.createElement('li');
			li.innerText = snap.val();
			li.id = snap.key;
			// alert(li.id);
			ulList.appendChild(li);

		});

		dbRefList.on('child_changed', snap => {

			const liChanged = document.getElementById(snap.key);
			console.log(snap.val());
			liChanged.innerText = snap.val();
		});

		dbRefList.on('child_removed', snap => {
			const liToRemove = document.getElementById(snap.key);
			liToRemove.remove();
		});


		// Shot in the dark

		function writeNewPost(uid, username, picture, title, body) {
	  // A post entry.
	  var postData = {
	    author: username,
	    uid: uid,
	    body: body,
	    title: title,
	    starCount: 0,
	    authorPic: picture
	  };

	  // Get a key for a new Post.
	  var newPostKey = firebase.database().ref().child('posts').push().key;

	  // Write the new post's data simultaneously in the posts list and the user's post list.
	  var updates = {};
	  updates['/posts/' + newPostKey] = postData;
	  updates['/user-posts/' + uid + '/' + newPostKey] = postData;

	  return firebase.database().ref().update(updates);
}







  </script>




</body>
</html>
